server:
  port: 8080
  compression:
    enabled: true
    mime-types: application/json,application/graphql+json,text/html,text/xml,text/plain,application/javascript,text/css
    min-response-size: 1024

spring:
  application:
    name: brokr-platform

  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/brokr}
    username: ${SPRING_DATASOURCE_USERNAME:nightslayer}
    password: ${SPRING_DATASOURCE_PASSWORD:}
    driver-class-name: org.postgresql.Driver
    hikari:
      # Connection pool configuration optimized for enterprise-level load
      minimum-idle: 10
      maximum-pool-size: 50  # Increased for concurrent metrics collection and queries
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      leak-detection-threshold: 60000
      # Performance optimizations
      register-mbeans: true  # Enable JMX monitoring
      pool-name: BrokrHikariPool

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        # Batch insert configuration optimized for enterprise-level metrics collection
        jdbc:
          batch_size: 100  # Increased for better throughput with large datasets
          order_inserts: true
          order_updates: true
        # Performance optimizations
        jdbc.batch_versioned_data: true
        # Query optimizations
        query.plan_cache_max_size: 2048
        query.plan_parameter_metadata_max_size: 128

  flyway:
    enabled: true
    locations: classpath:db

  graphql:
    path: /graphql
    graphiql:
      enabled: true
      path: /graphiql

  # Cache configuration optimized for enterprise-level load
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=5000,expireAfterWrite=5m,expireAfterAccess=2m
    cache-names:
      - kafkaMessages
      - topicMetrics
      - consumerGroupMetrics
      - clusterMetrics

jwt:
  secret: ${JWT_SECRET:XB0922J6WcWbXAgtFvmmebkfQUVMcjOqX4oag/xEHNY5E1MTFLQ2KSbqL52fmoGLHYCkkkJfzmGBB4vn6yYHlA==}
  expiration: ${JWT_EXPIRATION:86400}

logging:
  level:
    io.brokr: DEBUG
    io.brokr.kafka.service.KafkaConsumerService: DEBUG
    org.springframework.graphql: DEBUG
    org.apache.kafka: DEBUG