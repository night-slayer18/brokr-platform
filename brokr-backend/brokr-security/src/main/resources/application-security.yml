# brokr-security/src/main/resources/application-security.yml
spring:
  security:
    oauth2:
      client:
        provider:
          oidc:
          issuer-uri: ${OAUTH2_ISSUER_URI:http://localhost:8080}
          client-id: ${OAUTH2_CLIENT_ID:brokr-platform}
          client-secret: ${OAUTH2_CLIENT_SECRET:secret}
          client-name: Brokr Platform
          scope: openid,email,profile
          redirect-uri: ${OAUTH2_REDIRECT_URI:http://localhost:3000/callback}

  jwt:
    secret: ${JWT_SECRET:mySecretKey}
    expiration: ${JWT_EXPIRATION:86400}

  password:
    encoder:
      bcrypt:
        strength: strong
        enabled: true

  oauth2:
    provider:
    oidc:
      issuer-uri: ${OAUTH2_ISSUER_URI:http://localhost:8080}
      client-id: ${OAUTH2_CLIENT_ID:brokr-platform}
      client-secret: ${OAUTH2_CLIENT_SECRET:brokr-platform}
      client-name: Brokr Platform
      scope: openid,email,profile
      redirect-uri: ${OAUTH2_REDIRECT_URI:http://localhost:3000/callback}

# Password policies
password:
  policy:
  strength: strong
  min-length: 8
  max-length: 128
  username:
    pattern: "^[a-zA-Z0-9._-]+"
  password:
    pattern: "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%&*])[A-Za-z0-9._-]+$"

# Rate limiting
rate-limiting:
  enabled: true
  filter:
    login:
      limit: 5
      time-window: PT5M
    register:
      limit: 3
      time-window: PT1H
    password-reset:
      limit: 3
      time-window: PT1H